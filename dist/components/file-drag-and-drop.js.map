{"version":3,"file":"file-drag-and-drop.js","sources":["components/file-drag-and-drop.js"],"sourcesContent":["import { GenerateGuid } from \"../helpers/strings.js\";\n\nclass FileDragAndDrop {\n  constructor($module) {\n    this.$module = $module;\n    this.$input = $module.querySelector('input[type=\"file\"]');\n    this.$icons = $module.querySelector(\".fs-file-drag-and-drop__icons\");\n    this.$label = $module.querySelector(\".fs-file-drag-and-drop__label\");\n    this.iconsDefaultHTML = this.$icons.innerHTML;\n    this.labelDefaultHTML = this.$label.innerHTML;\n    this.id = `DragAndDrop-${GenerateGuid()}`;\n    this.create();\n  }\n  create() {\n    // Add a11y\n    this.$label.setAttribute(\"id\", this.id);\n    this.$label.setAttribute(\"aria-live\", \"polite\");\n    this.$input.setAttribute(\n      \"aria-describedby\",\n      this.$input.getAttribute(\"aria-describedby\")\n        ? this.$input.getAttribute(\"aria-describedby\") + \" \" + this.id\n        : this.id\n    );\n    // Bind events\n    this.$input.bindDragOver = this.onDragOver.bind(this);\n    this.$input.bindDragOut = this.onDragOut.bind(this);\n    this.$input.bindChange = this.onChange.bind(this);\n    this.$input.addEventListener(\"dragenter\", this.$input.bindDragOver, true);\n    this.$input.addEventListener(\"dragover\", this.$input.bindDragOver, true);\n    this.$input.addEventListener(\"dragleave\", this.$input.bindDragOut, true);\n    this.$input.addEventListener(\"drop\", this.$input.bindDragOut, true);\n    this.$input.addEventListener(\"change\", this.$input.bindChange, true);\n  }\n  onChange(e) {\n    this.handleFiles(e.target.files);\n  }\n  onDragOver() {\n    this.$module.classList.add(\"fs-file-drag-and-drop--highlight\");\n  }\n  onDragOut() {\n    this.$module.classList.remove(\"fs-file-drag-and-drop--highlight\");\n  }\n  handleFiles(files) {\n    this.resetFilePreview();\n    if (files.length) {\n      let fileNames = [];\n      let fileUrls = {};\n      this.$icons.innerHTML = \"\";\n      // Loop through files\n      [...files].forEach((file) => {\n        fileNames.push(file.name);\n        // Add image thumbnail (if it's an image)\n        if ([\"image/gif\", \"image/jpeg\", \"image/png\"].includes(file.type)) {\n          let reader = new FileReader();\n          reader.onload = (e) => {\n            let $previewImg = document.createElement(\"img\");\n            $previewImg.setAttribute(\"alt\", file.name);\n            $previewImg.classList.add(\"fs-file-drag-and-drop__icon\");\n            $previewImg.src = e.target.result;\n            this.$icons.appendChild($previewImg);\n          };\n          reader.readAsDataURL(file);\n        }\n      });\n      // Update label\n      if (fileNames.length === 1) {\n        this.$label.innerHTML = `Selected file: <strong>${fileNames[0]}</strong>.`;\n      } else {\n        this.$label.innerHTML = `Selected <strong>${fileNames.length} files</strong>.`;\n      }\n    }\n  }\n  resetFilePreview() {\n    this.$icons.innerHTML = this.iconsDefaultHTML;\n    this.$label.innerHTML = this.labelDefaultHTML;\n  }\n}\n\nexport default FileDragAndDrop;\n"],"names":["GenerateGuid","FileDragAndDrop","constructor","$module","this","$input","querySelector","$icons","$label","iconsDefaultHTML","innerHTML","labelDefaultHTML","id","create","setAttribute","getAttribute","bindDragOver","onDragOver","bind","bindDragOut","onDragOut","bindChange","onChange","addEventListener","e","handleFiles","target","files","classList","add","remove","resetFilePreview","length","fileNames","forEach","push","file","name","includes","type","reader","FileReader","onload","$previewImg","document","createElement","src","result","appendChild","readAsDataURL"],"mappings":"OAASA,+CAEHC,gBACJC,YAAYC,GACVC,KAAKD,QAAUA,EACfC,KAAKC,OAASF,EAAQG,cAAc,sBACpCF,KAAKG,OAASJ,EAAQG,cAAc,iCACpCF,KAAKI,OAASL,EAAQG,cAAc,iCACpCF,KAAKK,iBAAmBL,KAAKG,OAAOG,UACpCN,KAAKO,iBAAmBP,KAAKI,OAAOE,UACpCN,KAAKQ,kBAAoBZ,iBACzBI,KAAKS,SAEPA,SAEET,KAAKI,OAAOM,aAAa,KAAMV,KAAKQ,IACpCR,KAAKI,OAAOM,aAAa,YAAa,UACtCV,KAAKC,OAAOS,aACV,mBACAV,KAAKC,OAAOU,aAAa,oBACrBX,KAAKC,OAAOU,aAAa,oBAAsB,IAAMX,KAAKQ,GAC1DR,KAAKQ,IAGXR,KAAKC,OAAOW,aAAeZ,KAAKa,WAAWC,KAAKd,MAChDA,KAAKC,OAAOc,YAAcf,KAAKgB,UAAUF,KAAKd,MAC9CA,KAAKC,OAAOgB,WAAajB,KAAKkB,SAASJ,KAAKd,MAC5CA,KAAKC,OAAOkB,iBAAiB,YAAanB,KAAKC,OAAOW,cAAc,GACpEZ,KAAKC,OAAOkB,iBAAiB,WAAYnB,KAAKC,OAAOW,cAAc,GACnEZ,KAAKC,OAAOkB,iBAAiB,YAAanB,KAAKC,OAAOc,aAAa,GACnEf,KAAKC,OAAOkB,iBAAiB,OAAQnB,KAAKC,OAAOc,aAAa,GAC9Df,KAAKC,OAAOkB,iBAAiB,SAAUnB,KAAKC,OAAOgB,YAAY,GAEjEC,SAASE,GACPpB,KAAKqB,YAAYD,EAAEE,OAAOC,OAE5BV,aACEb,KAAKD,QAAQyB,UAAUC,IAAI,oCAE7BT,YACEhB,KAAKD,QAAQyB,UAAUE,OAAO,oCAEhCL,YAAYE,GAEV,GADAvB,KAAK2B,mBACDJ,EAAMK,OAAQ,CAChB,IAAIC,EAAY,GAEhB7B,KAAKG,OAAOG,UAAY,GAExB,IAAIiB,GAAOO,QAAQ,IAGjB,GAFAD,EAAUE,KAAKC,EAAKC,MAEhB,CAAC,YAAa,aAAc,aAAaC,SAASF,EAAKG,MAAO,CAChE,IAAIC,EAAS,IAAIC,WACjBD,EAAOE,OAAS,IACd,IAAIC,EAAcC,SAASC,cAAc,OACzCF,EAAY7B,aAAa,MAAOsB,EAAKC,MACrCM,EAAYf,UAAUC,IAAI,+BAC1Bc,EAAYG,IAAMtB,EAAEE,OAAOqB,OAC3B3C,KAAKG,OAAOyC,YAAYL,IAE1BH,EAAOS,cAAcb,MAIA,IAArBH,EAAUD,OACZ5B,KAAKI,OAAOE,oCAAsCuB,EAAU,eAE5D7B,KAAKI,OAAOE,8BAAgCuB,EAAUD,0BAI5DD,mBACE3B,KAAKG,OAAOG,UAAYN,KAAKK,iBAC7BL,KAAKI,OAAOE,UAAYN,KAAKO,iCAIlBV"}