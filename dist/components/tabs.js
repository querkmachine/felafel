import{KeyCodes}from"../helpers/key-codes.js";class Tabs{constructor(t){this.$module=t,this.$tabs=t.querySelectorAll(".fs-tabs__tab"),this.$tablist=t.querySelector(".fs-tabs__list"),this.$tablistItems=t.querySelectorAll(".fs-tabs__item"),this.panelHiddenClass="fs-tabs__panel--hidden",this.$tabs&&this.$tablist&&this.$tablistItems&&this.create()}create(){this.$tablist.setAttribute("role","tablist"),this.$tablistItems.forEach(t=>{t.setAttribute("role","presentation")}),this.$tabs.forEach(t=>{this.setAttributes(t),t.boundTabClick=this.onTabClick.bind(this),t.boundTabKeydown=this.onTabKeydown.bind(this),t.addEventListener("click",t.boundTabClick,!0),t.addEventListener("keydown",t.boundTabKeydown,!0),this.hideTab(t)});var t=this.getTab(window.location.hash)||this.$tabs[0];this.showTab(t),this.$module.boundOnHashChange=this.onHashChange.bind(this),window.addEventListener("hashchange",this.$module.boundOnHashChange,!0)}destroy(){this.$tablist.removeAttribute("role"),this.$tablistItems.forEach(t=>{t.removeAttribute("role","presentation")}),this.$tabs.forEach(t=>{t.removeEventListener("click",t.boundTabClick,!0),t.removeEventListener("keydown",t.boundTabKeydown,!0),this.unsetAttributes(t)}),window.removeEventListener("hashchange",this.$module.boundOnHashChange,!0)}setAttributes(t){var e=this.getHref(t).slice(1);t.setAttribute("id",e+"-Tab"),t.setAttribute("role","tab"),t.setAttribute("aria-controls",e),t.setAttribute("aria-selected","false"),t.setAttribute("tabindex","-1");const s=this.getPanel(t);s.setAttribute("role","tabpanel"),s.setAttribute("aria-labelledby",t.id),s.classList.add(this.panelHiddenClass)}unsetAttributes(t){t.removeAttribute("id"),t.removeAttribute("role"),t.removeAttribute("aria-controls"),t.removeAttribute("aria-selected"),t.removeAttribute("tabindex");const e=this.getPanel(t);e.removeAttribute("role"),e.removeAttribute("aria-labelledby"),e.classList.remove(this.panelHiddenClass)}onHashChange(t){const e=this.getTab(window.location.hash);var s;e&&(this.changingHash?this.changingHash=!1:(s=this.getCurrentTab(),this.hideTab(s),this.showTab(e),e.focus()))}createHistoryEntry(t){let e=this.getPanel(t);var s=e.id;e.id="",this.changingHash=!0,window.location.hash=this.getHref(t).slice(1),e.id=s}getTab(t){return this.$module.querySelector(`.fs-tabs__tab[href="${t}"]`)}getCurrentTab(){return this.$module.querySelector(".fs-tabs__item--current .fs-tabs__tab")}hideTab(t){this.unhighlightTab(t),this.hidePanel(t)}showTab(t){this.highlightTab(t),this.showPanel(t)}unhighlightTab(t){t.setAttribute("aria-selected","false"),t.parentNode.classList.remove("fs-tabs__item--current"),t.setAttribute("tabindex","-1")}highlightTab(t){t.setAttribute("aria-selected","true"),t.parentNode.classList.add("fs-tabs__item--current"),t.setAttribute("tabindex","0")}activateNextTab(){var t=this.getCurrentTab();const e=t.parentNode.nextElementSibling;let s;e&&(s=e.querySelector(".fs-tabs__tab")),s&&(this.hideTab(t),this.showTab(s),s.focus(),this.createHistoryEntry(s))}activatePreviousTab(){var t=this.getCurrentTab();const e=t.parentNode.previousElementSibling;let s;e&&(s=e.querySelector(".fs-tabs__tab")),s&&(this.hideTab(t),this.showTab(s),s.focus(),this.createHistoryEntry(s))}getPanel(t){return this.$module.querySelector(this.getHref(t))}showPanel(t){const e=this.getPanel(t);e.classList.remove(this.panelHiddenClass)}hidePanel(t){const e=this.getPanel(t);e.classList.add(this.panelHiddenClass)}onTabClick(t){if(!t.target.classList.contains("fs-tabs__tab"))return!1;t.preventDefault();var e=t.target,t=this.getCurrentTab();this.hideTab(t),this.showTab(e),this.createHistoryEntry(e)}onTabKeydown(t){switch(t.which||t.keyCode){case KeyCodes().LEFT:case KeyCodes().UP:this.activatePreviousTab(),t.preventDefault();break;case KeyCodes().RIGHT:case KeyCodes().DOWN:this.activateNextTab(),t.preventDefault()}}getHref(t){const e=t.getAttribute("href");return e.slice(e.indexOf("#"),e.length)}}export default Tabs;
//# sourceMappingURL=tabs.js.map
