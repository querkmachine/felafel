@use "../settings/typography-size" as settings;
@use "measurements";
@use "media-queries";

@use "sass:map";
@use "sass:math";

// Convert pixel line-heights into relative values
@function _fs-line-height($line-height, $font-size) {
  @if not
    math.is-unitless($line-height) and
    math.unit($line-height) ==
    math.unit($font-size)
  {
    $line-height: $line-height / $font-size;
  }
  @return $line-height;
}

// Responsive font-size mixin
@mixin fs-font-size($size, $important: false) {
  @if not map.has-key(settings.$fs-font-sizes-responsive, $size) {
    @error "Unknown font size `#{$size}` - expected a point from the typography scale.";
  }
  $size-map: map.get(settings.$fs-font-sizes-responsive, $size);
  @each $breakpoint, $breakpoint-map in $size-map {
    $font-size: map.get($breakpoint-map, "font-size");
    $font-size-rem: measurements.fs-px-to-rem($font-size);
    $line-height: _fs-line-height(
      map-get($breakpoint-map, "line-height"),
      $font-size
    );
    @if $important {
      $font-size: $font-size !important;
      $font-size-rem: $font-size-rem !important;
      $line-height: $line-height !important;
    }
    @if ($breakpoint == null) {
      font-size: $font-size-rem;
      line-height: $line-height;
    } @else {
      @include media-queries.fs-mq($from: $breakpoint) {
        font-size: $font-size-rem;
        line-height: $line-height;
      }
    }
  }
}
